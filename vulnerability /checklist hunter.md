# 🛡️ checklist hunter

## 🔹 1. آسیب‌پذیری‌هایی که تست می‌شوند

### دستی (Manual)
- **IDOR / BOLA**: تغییر `id`, `user_id`, `account`  
- **Business Logic Flaws**: کوپن، پرداخت، محدودیت‌ها  
- **Authentication Issues**: Bypass لاگین، Reset Password، Session Hijacking  
- **CSRF**: تست تغییر داده بدون CSRF Token  
- **Race Condition**: تست درخواست همزمان روی APIهای حساس  
- **File Upload Bypass**: تغییر پسوند، MIME Type، Null Byte Injection  
- **Advanced XSS / DOM-XSS**: تست روی ورودی‌های غیرمعمول (JS Sinkها، Markdown، PDF Viewer)  
- **SSRF**: تست روی پارامترهای `url`, `redirect`, `path`  

### خودکار (Automated)
- **SQL Injection ساده**  
- **XSS ساده (Reflected)**  
- **Directory/File Bruteforce**  
- **Misconfiguration اساسی (Headers, SSL, Open Ports)**  
- **Vulnerability Scanning با Nuclei, Nikto, Arachni**  

---

## 🔹 2. پارامترها و Endpointهای حساس

### پارامترهای رایج برای تست
- `id`, `uid`, `user_id`, `account_id`  
- `redirect`, `next`, `url`, `target`  
- `file`, `path`, `dir`, `template`  
- `email`, `username`, `token`, `session`  
- `q`, `search`, `filter`, `sort`  
- `amount`, `price`, `quantity`, `coupon`  

### Endpointهای حساس
- `/api/*` → مخصوصاً مربوط به کاربران یا پرداخت  
- `/admin/*` → دسترسی غیرمجاز  
- `/upload/*` → تست File Upload  
- `/auth/*`, `/login`, `/reset-password`  
- `/graphql` یا `/api/v2/graphql`  
- Backup/hidden files: `/backup.zip`, `/.git/`, `/config.php`  

---

## 🔹 3. ابزارهای امنیتی مورد استفاده

### برای جمع‌آوری (Recon)
- `amass`, `subfinder`, `assetfinder`, `crt.sh`  
- `gau`, `waybackurls`, `katana` (URL Discovery)  
- `httpx`, `httprobe` (لایو بودن دامنه‌ها)  

### برای تست خودکار
- **Burp Suite Pro / Community**  
- **OWASP ZAP**  
- **Nuclei** (CVE & misconfiguration templates)  
- **Nikto**, **WhatWeb**, **Wappalyzer**  

### برای Brute Force / Discovery
- `ffuf`, `gobuster`, `dirsearch`  
- `paramspider`, `Arjun` (پارامترهای مخفی)  

### برای Exploitation
- Burp Intruder / Turbo Intruder  
- `sqlmap` (SQL Injection)  
- `XSStrike` (XSS)  

---

## 🔹 4. زبان‌های برنامه‌نویسی و اسکریپت‌ها

### زبان‌های رایج
- **Python** → برای اسکریپت‌های خودکار (Recon, Parameter Fuzzing, Payload Injection)  
- **Go** → ابزارهای مدرن امنیتی (httpx, subfinder, ffuf)  
- **Bash** → برای اجرای chain ابزارها  

روش تشخیص URLهای جدید (مقایسه اسکن‌ها)

اجرای gau یا waybackurls برای جمع‌آوری URLها
```
gau target.com > urls_day1.txt
gau target.com > urls_day2.txt
```

استفاده از sort و diff برای مقایسه:
```
sort urls_day1.txt > day1_sorted.txt
sort urls_day2.txt > day2_sorted.txt
diff day1_sorted.txt day2_sorted.txt > new_urls.txt
```

ابزارهای پیشرفته‌تر مثل katana هم می‌تونن Crawl روزانه انجام بدن.

جداسازی پارامترهای جدید

ابزار: paramspider یا arjun → کشف پارامترهای جدید

روش دستی: استخراج Query Stringها و مقایسه

```
cat urls_day2.txt | grep "?" | cut -d "?" -f2 | cut -d "=" -f1 | sort -u > params_day2.txt
diff params_day1.txt params_day2.txt > new_params.txt
```



===========================================================================================================
===========================================================================================================

آسیب‌پذیری‌های کلیدی برای بررسی دستی و اتوماتیک
IDOR: تست مستقیم تغییر شناسه‌ها و پارامترها برای دسترسی غیرمجاز

XSS (Cross-Site Scripting): تزریق اسکریپت به ورودی‌ها، query, body, headers

SQL Injection: تزریق کد SQL در پارامترهای ورودی

CSRF (Cross-Site Request Forgery): تست کنترل اعتبار درخواست‌های حساس

Authentication issues: ضعف در مکانیزم ورود، Session، JWT

Access Control / Authorization flaws: تست تجاوز سطوح دسترسی

File upload vulnerabilities: آپلود فایل‌های مخرب

SSRF، RCE، Command Injection: تست ورودی‌ها در مکان‌های خطرناک

Open Redirect و URL Manipulation: تغییر لینک‌ها برای هدایت به سایت مخرب

Business Logic Flaws: مشکلات خاص برنامه که منجر به سوءاستفاده می‌شود

Security Misconfigurations: Headers امنیتی، TLS، CSP، CORS

پارامترها و Endpointهایی که روی آنها کار می‌شود
پارامترهای مرتبط با شناسه‌ها (id, user_id, order_id, file_id)

پارامترهای فرم‌های ورود، ثبت نام، آپلود و مدیریت فایل

API endpoints، مخصوصاً REST و GraphQL

مسیرهای با query string و JSON body

نقاط دسترسی به داشبورد مدیریت، تنظیمات کاربری و منابع خصوصی

مواردی که در کوکی‌ها، هدرها، توکن‌های JWT هستند

urlهای مربوط به عملیات CRUD (Create, Read, Update, Delete)

ابزارهای امنیتی پرکاربرد
Burp Suite: برای تست‌های ترکیبی دستی و اتوماتیک، payloadهای سفارشی

OWASP ZAP: جایگزین رایگان برای Burp با امکان اسکن خودکار

sqlmap: تست اتوماتیک تزریق SQL

Nmap: اسکن پورت و سرویسی

ParamSpider، Arjun، FFuF: کشف پارامترهای ورودی و دایرکتوری‌ها

Dirsearch، Feroxbuster: کشف مسیرها و فایل‌های مخفی

Sublist3r، Amass: کشف ساب‌دامین و دارایی‌های آنلاین

Custom Scripts در پایتون، Bash: برای اتوماسیون کارهای خاص

Monitoring و گزارش تغییرات: مثل استخدام اسکریپت‌های متا داده و مقایسه خروجی‌های اسکن


=======================================================================================
=======================================================================================

انواع آسیب‌پذیری‌های مورد تست
۱. آسیب‌پذیری‌های کلاسیک OWASP Top 10:
```
تزریق SQL (SQLi)

اسکریپت‌نویسی بین سایت‌ای (XSS)

جعل درخواست بین سایت‌ای (CSRF)

افشای اطلاعات حساس

کنترل دسترسی شکسته (BAC/IDOR)

پیکربندی نادرست امنیتی

احراز هویت شکسته

م componentsلفات با آسیب‌پذیری‌های شناخته شده
```

۲. آسیب‌پذیری‌های پیشرفته:
```
Server-Side Request Forgery (SSRF)

XML External Entity (XXE)

Insecure Deserialization

Subdomain Takeover

JWT Vulnerabilities

GraphQL Injection

WebSocket Vulnerabilities
```
پارامترهای کلیدی برای تست

پارامترهای عمومی:

```
id, user_id, account_id, order_id, file, path, redirect, url, callback, jsonp, token, auth, access_token, api_key, secret, password, email, username
```

پارامترهای خاص براساس context:
```
تست IDOR: user_id, account_id, order_id, document_id

تست XSS: search, q, name, comment, message

تست SQLi: id, category, product_id, user

تست LFI/RFI: file, path, include, page

تست SSRF: url, endpoint, api, webhook

تست Open Redirect: redirect, next, return, url
```

Endpoint های مهم

endpoint های عمومی:
```
/admin, /login, /api, /graphql, /upload, /export, /import, /backup, /config, /env, /.git, /wp-admin, /phpmyadmin, /console, /actuator, /phpinfo
```

endpoint های API:
```
/api/v1/users, /api/auth, /api/config, /api/export, /graphql, /rest/users, /soap/api
```

endpoint های حساس:

```
/.env, /config.json, /package.json, /composer.json, /web.config, /server-status, /debug, /test
```
روش‌های تست دستی و اتوماتیک
تست دستی:
```
تست تغییر متدهای HTTP (GET به POST، PUT، DELETE)

تست تغییر هدرها (X-Forwarded-For, Host, User-Agent)

تست تغییر پارامترها (تغییر مقدار، نوع داده، طول داده)

تست Business Logic (منطق کسب و کار برنامه)

تست Race Conditions

تست حملات زمان‌بندی (Timing Attacks)
```
تست اتوماتیک:
```
اسکنرهای امنیتی (Burp Suite, OWASP ZAP)

ابزارهای fuzzing (ffuf, wfuzz, Burp Intruder)

ابزارهای کشف محتوا (dirb, dirsearch, gospider)

ابزارهای آنالیز استاتیک (semgrep, CodeQL)

ابزارهای تست API (Postman, Bruno)
```
ابزارهای امنیتی مورد استفاده
ابزارهای اصلی:
```
Burp Suite Professional (اسکنر و پروکسی)

OWASP ZAP (اسکنر متن باز)

Nuclei (اسکنر مبتنی بر تمپلیت)

sqlmap (تزریق SQL)

ffuf (fuzzing وب)

Amass (کشف ساب دامنه)

Subfinder (کشف ساب دامنه)
```
================================================================
================================================================
