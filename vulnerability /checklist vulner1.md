
سریع — نقشهٔ پارامتر → آسیب‌پذیری

(برای هر مورد: مثال نام پارامتر/endpoint، چه بررسی کنیم، پروب ابتدایی، نکتهٔ کشف)


---

1) XSS (Cross-Site Scripting)

پارامترها/نقاط رایج: q, search, name, comment, message, username, any free-text fields, URL path segments, fragment/hash.

چک: ورودی در خروجی HTML/JS بازتاب می‌شود یا در attribute/JS قرار می‌گیرد بدون escaping.

پروب ابتدایی: ارسال کاراکترهای < > و رشته‌هایی که HTML ساده تولید کنند. (مثلاً <script>alert(1)</script> برای بررسی بازتاب — سپس بررسی کنید که خروجی html encode شده یا نه.)

نکته: تفاوت بین reflected, stored و DOM-based رو جداکن. تست روی فیلترها (attribute, event handlers, URL params) انجام بده.



---

2) SQL Injection

پارامترها/نقاط رایج: id, user, search, filter, page, هر پارامتری که مستقیماً query می‌سازد (POST body, JSON, cookie, header).

چک: خطاهای دیتابیس، تغییر در تعداد نتایج، پاسخ‌های کند یا ناسازگار.

پروب/تست ابتدایی: ارسال quote-like characters (' یا ") و بررسی خطای SQL یا تفاوت در محتوا/طول پاسخ.

نکته: پارامترهای numeric هم ممکنه آسیب‌پذیر باشند؛ تست پارامترهای hidden/form fields و API JSON.



---

3) CSRF (Cross-Site Request Forgery)

نقاط رایج: state-changing endpoints: /change-email, /transfer, /settings, POST/PUT/DELETE endpoints.

چک: آیا درخواست‌های state-changing نیاز به توکن anti-CSRF دارند؟ آیا توکن مربوط به session است یا ثابت؟

پروب: بررسی اینکه یک POST ساده بدون CSRF token پذیرفته می‌شود یا نه (با حسابی که اجازه دارین).

نکته: APIهای JSON و CORS را هم بررسی کن (preflight، allowed origins).



---

4) IDOR (Insecure Direct Object Reference)

پارامترها/نقاط رایج: user_id, file_id, invoice, order, document, path segments مثل /download/12345.

چک: تغییر عدد/شناسه به شناسهٔ دیگر باعث دسترسی به داده‌های دیگر می‌شود؟

پروب: مقدار id را به دیگر شناسه‌ها تغییر بده و ببین آیا اجازه دسترسی هست.

نکته: JWT/encoded IDs را هم بررسی کن — گاهی فقط Base64 یا predictable هستند.



---

5) File Upload (RCE / Malware / Path traversal)

نقاط رایج: upload endpoints، avatars، attachments، import.

چک: آیا فرمت/نوع فایل و اندازه بررسی می‌شود؟ محتوا scan می‌شود؟ اجازهٔ اجرای فایل در سرور داده می‌شود؟

پروب: آپلود فایل متنی ساده (مثلاً .txt) و تغییر نام/محتوا برای بررسی mime-type handling.

نکته: بررسی کنید فایل‌ها کجا ذخیره می‌شوند و آیا از نام‌های تصادفی استفاده می‌شود یا اسم ارسالی مستقیم.



---

6) LFI / RFI / Path traversal

پارامترها/نقاط رایج: file, page, template, lang, any include/path param.

چک: آیا امکان ../ یا درخواست فایل‌های داخلی وجود دارد؟ آیا ورودی در include/require استفاده می‌شود؟

پروب: ارسال توکن‌های path traversal (../) و بررسی تفاوت در پاسخ/خطا.

نکته: بررسی log files، passwd، config files (فقط در محیط تست با اجازه).



---

7) SSRF (Server-Side Request Forgery)

پارامترها/نقاط رایج: url, redirect, img, callback, webhook, هر پارامتر که سرور ازش برای fetch کردن URL استفاده کنه.

چک: آیا می‌توان URL داخلی (127.0.0.1, localhost, metadata endpoints) را فراخوانی کرد؟ آیا DNS resolution داخلی انجام می‌شود؟

پروب: ارسال URL به دامنه‌ای که قابل کنترلِ شما (برای دیدن تماس خروجی) یا به loopback برای بررسی پاسخ.

نکته: مراقب api cloud metadata باشید (مثلاً AWS/Google) — ولی فقط در محیط تست با اجازه.



---

8) Open Redirect

پارامترها/نقاط رایج: next, return, redirect, url, continue, goto.

چک: آیا می‌توان redirect به دامنهٔ خارجی ساخت؟

پروب: مقداردهی به یک URL خارجی و بررسی اینکه سرور redirect می‌کند یا نه.

نکته: Open redirect‌ها برای فیشینگ/حملات ترکیبی خطرناک‌اند.



---

9) Command Injection / OS Injection

پارامترها/نقاط رایج: پارامترهایی که به shell پاس داده می‌شوند: cmd, file, host, ip, پارامترهای sysadmin-like.

چک: آیا ورودی در یک دستور سیستم استفاده می‌شود؟ تفاوت در خروجی/خطا پس از ارسال کاراکترهایی مانند ; | &&.

پروب ابتدایی: ارسال کاراکترهای جداکننده و بررسی خطا/تغییر خروجی.

نکته: بسیار خطرناک — فقط در محیط کنترل‌شده و با اجازه مطلق تست کن.



---

10) XXE (XML External Entity)

نقاط رایج: ورودی XML: SOAP, XML upload, XML APIs.

چک: آیا parser اجازه external entity دارد؟ خطاهای parser یا تماس به منابع خارجی.

پروب: ارسال XML که شامل external entity باشد (فقط برای تست در محیط آزمایشگاهی).

نکته: XML parserهای قدیمی به شدت آسیب‌پذیرند.



---

11) Auth / Session issues (Bruteforce / Weak auth / Session fixation)

پارامترها/نقاط رایج: username, password, token, session cookie names (session, sid, auth_token).

چک: account lockout, password reset flow, weak passwords, predictable session IDs.

پروب: بررسی پاسخ‌های متفاوت برای وجود/عدم وجود کاربر، زمان‌بندی پاسخ، بررسی headers Set-Cookie.

نکته: تست brute-force فقط با اجازه و با ابزارهای مناسب و محدوده‌گذاری.



---

12) Insecure Deserialization

نقاط رایج: پارامترهایی که serialized data می‌گیرند: data, cookies حاوی serialized payload، JSON Web Token‌های سفارشی، pickles.

چک: آیا deserialize بدون validation انجام می‌شود؟ آیا کلاسهای خطرناک لود می‌شوند؟

نکته: پیچیده و خطرناک — نیازه تجربه و محیط تست.



---

لیست اسم پارامترهای حساس (چک سریع)

id, user, uid, username, userid, file, filename, file_id, doc, token, session, auth, password, pass, q, search, page, redirect, next, url, return, callback, img, image, email, phone, lang, locale, type, order, invoice, account, amount, transfer, amount
(هر ورودی متنی یا شناسه‌ای که آزادانه تغییر‌پذیره — هدف بگیر)


---

ابزارها و روش‌های مفید (خلاصه)

جمع‌آوری پارامترها: Burp (Proxy), FFUF/feroxbuster برای endpoints, gau/gobuster برای URLs.

فازی/فازیینگ پارامترها: ffuf, wfuzz, Burp Intruder.

اسکن خودکار SQL/XSS: sqlmap (با احتیاط)، DOMInvader، Burp Scanner.

آزمون فایل آپلود: بررسی content-type, magic bytes, storage path.

آزمون SSRF: استفاده از سروری که لاگ تماس‌ها را ثبت می‌کند (فقط در محیط تست/با permission).

اولویت: ابتدا نقاطی که state-changing هستند و حساس به auth، سپس نمایش اطلاعات (info leak)، سپس injection‌ها.



---

یک چک‌لیست عملی کوتاه (برای هر target)

1. جمع‌آوری: تمام پارامترها در forms, JSON, headers, cookies, URL query, path.


2. طبقه‌بندی: input → چه نوع (text, file, numeric, url, json).


3. پروب پایه: ارسال کاراکترهای تستی (' " < > ../)، بررسی خطا/تفاوت.


4. هدف‌گذاری: براساس پاسخ‌ها، به تست تخصصی‌تر (XSS/SQL/SSRF/IDOR) برو.


5. گزارش: برای هر یافته، reproduction steps + severity + remediation suggestion.
