| #  | Vulnerability                  | Sensitive Parameters                         | Example Endpoint                            | Sample Payload (Test)                           |
|----|--------------------------------|---------------------------------------------|---------------------------------------------|------------------------------------------------|
| 1  | IDOR (Insecure Direct Object)  | id, uid, user_id, account, profile, orderId  | /api/user?uid=123                           | Change `uid=123` ➝ `uid=124` (see another user) |
| 2  | Broken Access Control (BAC)    | role, admin, isAdmin, permission, access     | /api/updateRole?uid=123&role=user           | Change `role=user` ➝ `role=admin`              |
| 3  | SQL Injection (Error/Union)    | id, q, query, search, filter, category       | /product?category=1                         | `' OR '1'='1 --` <br> `1 UNION SELECT NULL--`   |
| 4  | SSRF (Server-Side Request Forg.)| url, redirect, callback, dest, next, host    | /fetch?url=http://example.com               | `http://127.0.0.1:80` <br> `http://169.254.169.254/latest/meta-data/` |
| 5  | Authentication Bypass          | token, access_token, id_token, session, code | /login?token=XYZ                            | Use NULL / Empty Token / Replay JWT             |
| 6  | Account Takeover (ATO)         | email, reset, token, session, sid, code      | /reset?email=user@test.com&token=123        | Change victim email ➝ Receive reset link        |
| 7  | RCE / Shell Upload             | file, filename, upload, template, exec       | /upload?file=shell.php                      | `<?php system($_GET['cmd']); ?>`                |
| 8  | Unrestricted File Upload       | image, avatar, uploadFile, fileData          | /api/upload/avatar                          | Upload `.php` / `.jsp` disguised as `.jpg`      |
| 9  | Race Condition                 | amount, price, transfer, order, checkout     | /purchase?item=123&price=100                | Send parallel requests ➝ Double purchase        |
| 10 | Path Traversal / File Deletion | file, filepath, dir, path, delete, remove    | /download?file=report.pdf                   | `../../../../etc/passwd` <br> `../../var/www/html/config.php` |

======================================================================================================

چند نکته‌ی هانترها:

برای IDOR & BAC همیشه تست روی /api/ و /admin/ انجام میشه.

برای SSRF بهترین شانس روی پارامترهای url, redirect_uri, target هست.

برای RCE/File Upload تست رو با دوبار تغییر Content-Type یا تغییر پسوند فایل می‌زنن.

برای Race Condition از ابزارهایی مثل Turbo Intruder یا Burp Repeater (parallel) استفاده میشه.

======================================================================================================


چک‌لیست عملی P1 برای باگ‌بانتی
1) IDOR (Insecure Direct Object Reference)

پارامترهای رادار: id, uid, user_id, account, orderId, invoiceId
کجاها؟ /api/*, /profile, /orders/*, لینک‌های اشتراک‌گذاری

 با اکانت A لاگین کن، یک ریسورس متعلق به A را با شناسه‌اش بگیر (Baseline).

 همان درخواست را با اکانت B تکرار کن و فقط شناسه را به A تغییر بده.

 نسخه‌های متفاوت را تست کن: GET/PUT/DELETE، پارامتر در Query/Path/Body.

 اگر می‌بینی پاسخ شامل داده/عملیات غیرمجاز است ⇒ IDOR.
PoC امن: فقط خواندن ریسورس‌های غیرحساس، داده‌ها را ماسک کن.
اسکالیشن: اگر امکان «ویرایش/حذف» هم بدون مجوز بود ⇒ P1 قطعی.

2) Broken Access Control (BAC)

پارامترهای رادار: role, isAdmin, permission, access, group
کجاها؟ /admin/*, /settings, /api/users/*

 همه‌ی اکشن‌های حساس را فهرست کن (Create/Update/Delete در نواحی ادمین).

 همان درخواست‌ها را با نقش پایین‌تر بفرست (کاربر ساده / ناشناس).

 تغییر روش‌ها (GET⇄POST)، حذف هدرهای Auth، یا دستکاری فیلدهای سطح دسترسی را امتحان کن.

 اگر سرور صرفاً به «وجود فیلد» اعتماد داشت ⇒ BAC.
PoC امن: اجرای یک عمل کم‌خطر (مثلاً تغییر نام نمایشی تست).
اسکالیشن: اثبات دسترسی به اندپوینت‌های ادمین یا اعمال سیستمی.

3) SQL Injection (Error/Union/Blind)

پارامترهای رادار: id, q, query, search, filter, sort, category
کجاها؟ لیست/جستجو/جزئیات آیتم‌ها، پارامترهای Path/Query/JSON

 ورودی‌های قابل‌جستجو یا شناسه‌ها را شناسایی کن.

 دنبال تفاوت رفتاری باش: خطای غیرعادی، تغییر در تعداد نتایج، تفاوت زمان پاسخ.

 اگر خطای پایگاه‌داده یا رفتار غیرمنتظره دیدی ⇒ مشکوک به SQLi.
PoC امن: نشان بده فیلتر/Sort خارج از انتظار کار می‌کند (بدون استخراج دیتا).
اسکالیشن: اگر ستون/تعداد ستون را بتوانی (در محیط امن/لابراتوار) حدس بزنی ⇒ گزارش را با شواهد رفتاری مستند کن، نه دامپ داده.

4) SSRF (Server-Side Request Forgery)

پارامترهای رادار: url, redirect, target, host, callback
کجاها؟ “fetcher/proxy/downloader/previewer”، وب‌هوک‌ها

 نقطه‌ای که سرور برایت URL را «فچ» می‌کند پیدا کن.

 یک آدرس کنترل‌شده (Collab/Request Bin) بگذار و ببین آیا سرور درخواست بیرونی می‌زند یا نه.

 بررسی کن فیلترها فقط جلوی دامنه‌ها/اسکیماهای بدیهی را می‌گیرند یا نه (بدون دورزدن خطرناک).
PoC امن: فقط اثبات «تماس خروجی» با هدر/Log خودت—بدون دسترسی به شبکه داخلی هدف.
اسکالیشن: اشاره کن که می‌تواند به دسترسی داخلی/اسرار کلاد منجر شود، ولی از تست تهاجمی خودداری کن.

5) Authentication Bypass

پارامترهای رادار: token, access_token, id_token, code, session, continue
کجاها؟ لاگین/SSO/OAuth/لینک‌های “Continue as …”

 فلوهای ورود/خروج/مرا به خاطر بسپار/امنیت چندمرحله‌ای را نقشه‌برداری کن.

 سعی کن مرحله‌ای را «اسکیپ» کنی (مثلاً ورود مهمان→حساب کامل) یا از لینک‌های موقت بدون اعتبارسنجی استفاده کنی.

 بررسی کن آیا سمت‌کلاینت به‌تنهایی تصمیم می‌گیرد (پرچم لاگین در LocalStorage و …).
PoC امن: نشان بده بدون گذر از کنترل لازم وارد ناحیه محافظت‌شده می‌شوی (بدون تغییر داده واقعی).
اسکالیشن: اگر به هر حسابی می‌توان سوییچ کرد ⇒ ATO احتمالی.

6) Account Takeover (ATO)

پارامترهای رادار: email, token, code, reset, otp, link
کجاها؟ بازیابی رمز، تغییر ایمیل/شماره، پیوند حساب‌ها، SSO

 ریست‌پسورد: توکن باید به کاربر و به نشست/کانال و به زمان گره خورده باشد.

 بررسی کن توکن‌ها یکبارمصرف‌اند و با تغییر ایمیل/ریدایرکت قابل سوءاستفاده نیستند.

 مسیر تغییر ایمیل/شماره: آیا تأیید «عامل فعلی» (رمز/OTP) می‌خواهد؟
PoC امن: کنترل حساب خودت یا یک حساب تست در اسکوپ—نه قربانی واقعی.
اسکالیشن: اگر با دستکاری فلو به حساب دیگری می‌رسی ⇒ P1.

7) RCE / Shell Upload

پارامترهای رادار: file, filename, template, view, exec, engine
کجاها؟ آپلود فایل، پردازش قالب/تمپلیت، کانورت/ری‌سایز، ایمپورت/بکاپ

 مشخص کن فایل کجا ذخیره/پردازش می‌شود (backend vs CDN).

 بررسی کن اعتبارسنجی پسوند/MIME/محتوا سمت‌سرور انجام می‌شود یا نه.

 اگر فایل «تفسیر» می‌شود (template/script) ⇒ خطر اجرای کد.
PoC امن: رندر یک «مارکر بی‌خطر» یا تماس به کلاب خودت از داخل پردازش—بدون اجرای دستور مخرب.
اسکالیشن: اگر ثابت شد محتوای دلخواه اجرا می‌شود ⇒ P1 با محدوده اثر.

8) Unrestricted File Upload

پارامترهای رادار: upload, image, avatar, fileData, filePath
کجاها؟ پروفایل‌ها، تیکتینگ، WYSIWYG، ایمپورت CSV/XML

 بررسی کن فقط نوع‌های مجاز، اندازه محدود، آنتی‌ویروس/سندباکس، تصادفی‌سازی نام، و مسیر مجزا دارد یا نه.

 تست ذخیره در مسیر قابل‌دسترسی عموم و تلاش برای اجرا/دانلود همان فایل (فقط فایل بی‌خطر).
PoC امن: آپلود فایل بی‌خطر و اثبات دسترسی عمومی/فراخوانی غیرمنتظره.
اسکالیشن: اگر منجر به اجرای سروری شود ⇒ به بخش 7 پیوند بده.

9) Race Condition

پارامترهای رادار: amount, price, coupon, transferId, orderId, status
کجاها؟ پرداخت/کوپن/برداشت موجودی/ایجاد سشن/ثبت نام

 عملیات غیراتمی را پیدا کن (دو مرحله بررسی→کسر→تأیید).

 چند درخواست یکسان را همزمان بفرست و اثر خالص را بسنج (دو شارژ/دو برداشت/چندبار استفاده).

 دنبال قفل‌گذاری/تکرارناپذیری/ایده‌مپوتنسی (Idempotency-Key) باش.
PoC امن: مقدارهای کوچک/آیتم تست، مستندسازی اختلاف قبل/بعد.
اسکالیشن: اگر وضعیت مالی/منابع دو بار تغییر کرد ⇒ P1.

10) Path Traversal / Arbitrary File Deletion

پارامترهای رادار: file, filepath, path, dir, download, delete, remove
کجاها؟ دانلود/پیش‌نمایش/Zip Export، حذف فایل/لاگ

 ورودی مسیر را پیدا کن؛ تلاش برای خروج از دایرکتوری مجاز با الگوی کلی traversal (بدون اشاره به مسیرهای حساس واقعی).

 برای حذف/پاکسازی، بررسی کن آیا مسیر مقصد محدود/نرمالایز می‌شود یا نه.

 تفاوت پاسخ‌ها (200/403/404) و محتوا را ثبت کن.
PoC امن: دسترسی/حذف فایل تست در یک مسیر بی‌خطر.
اسکالیشن: امکان خواندن/حذف خارج از محدوده ⇒ P1.

شواهد و گزارش (برای همه موارد)

 Scope & Impact: اندپوینت، نقش کاربر، پیامد کسب‌وکار (Data Exposure/ATO/RCE/مالی).

 Steps to Reproduce: ۳–۵ گام مختصر با درخواست/پاسخ نمونه (داده‌ها ماسک شوند).

 Evidence: اسکرین/لگ کنترل‌شده (بدون انتشار اسرار).

 Limitations & Safe-guards: توضیح دادی که تست را امن انجام دادی و چه چیزی عمداً انجام ندادی.

 Remediation Hints: کنترل دسترسی، ولیدیشن ورودی، توکن‌های قوی، CSP/WAF، لاگ/آلارم.


 
======================================================================================================



======================================================================================================
