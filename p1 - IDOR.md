# p1 - IDOR:


## parameter:

===>>> {api/users/1}

===>>> {user_id}

===>>> {_id}


=========================================================

همیشه پارامترهایی که ID یا resource اشاره می‌کنن رو بررسی کن:
id, user_id, order_id, account, profile, invoice, ticket, doc, file, uid, pid, cid

تغییر عددی ساده: id=123 ➝ id=124

حذف کوکی یا Authorization Header ببین بدون لاگین هم جواب میده یا نه.

تست با اکانت‌های مختلف (Admin vs User).

تست روی GET و POST هر دو. خیلی وقت‌ها توی API POST IDOR هست.

دقت کن بعضی وقت‌ها UUID/GUID می‌ذارن (f152a155-...) ولی باز هم قابل تغییر و حدس زدنه.

از Burp Autorize استفاده کن تا درخواست‌ها به صورت خودکار با کوکی کاربر عادی تکرار بشن.

ترکیب با Logger++ برای مانیتور همه‌ی درخواست‌ها (هیچ چیزی از دست نره).

## Access Control / IDOR Checklist

- [ ] با اکانت Admin لاگین کن و یک ریسورس حساس رو باز کن (مثلاً /orders/123).
- [ ] همون درخواست رو با کوکی/توکن User عادی تکرار کن.
- [ ] پاسخ‌ها رو مقایسه کن (Burp Autorize خیلی کمک می‌کنه).
- [ ] شماره ID یا پارامترها رو تغییر بده (123 ➝ 124).
- [ ] تست کن بدون Authorization Header هم جواب میده یا نه.
- [ ] اگر API هست:
  - [ ] تست کن پارامترهای JSON (`"user_id": 123`) رو تغییر بدی.
  - [ ] تست روی endpoints مثل `/api/v1/user/123`, `/api/v1/orders/456`.
- [ ] تست کن که File Download ها هم محدود شدن یا نه (`/files/report_123.pdf`).
- [ ] بررسی کن عملیات Create/Update/Delete هم کنترل دسترسی داره یا فقط View.
- [ ] اگر UUID هست، تست کن مقادیر رو جایگزین کنی (خیلی وقتا IDOR با UUID هم میشه).


=========================================================
